fun listlen list=
  if list == nil then
    0
  else
    1 + listlen tl list
;;

fun listtostr list=
  let strnew listlen list -> s in
  let 0 -> i in
  (
    for p = list; p != nil; tl p do
    (
      strset s i hd p;
      set i = i + 1
    );
  s
  )
;;
